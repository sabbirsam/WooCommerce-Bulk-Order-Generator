jQuery(document).ready((function(e){var t=localStorage.getItem("activeTab");t?(e(".nav-tab").removeClass("nav-tab-active"),e(".tab-content").removeClass("active"),e('.nav-tab[href="'.concat(t,'"]')).addClass("nav-tab-active"),e(t).addClass("active")):(e(".nav-tab").first().addClass("nav-tab-active"),e(".tab-content").first().addClass("active")),e(".nav-tab").on("click",(function(t){t.preventDefault(),e(".nav-tab").removeClass("nav-tab-active"),e(this).addClass("nav-tab-active"),e(".tab-content").removeClass("active"),e(e(this).attr("href")).addClass("active"),localStorage.setItem("activeTab",e(this).attr("href"))}))})),jQuery(document).ready((function(e){e(".file-upload-input").on("change",(function(t){var r=t.target.files[0],o=e(".file-upload-preview");r&&o.html(' \n                <div class="file-name-display">\n                    ðŸ“„ '.concat(r.name,"\n                </div>\n            "))}))})),jQuery(document).ready((function(e){function t(t){var r=e('\n            <div class="wc-toast '.concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",'">\n                ').concat(t,"\n            </div>\n        "));e("#toast-container").append(r),setTimeout((function(){return r.css("opacity","1")}),10),setTimeout((function(){r.css("opacity","0"),setTimeout((function(){return r.remove()}),300)}),3e3)}e("#toast-container").length||e("body").append('<div id="toast-container" style="position: fixed; top: 40px; right: 20px; z-index: 10000;"></div>');var r,o=!1,a=0,n=0,s=0,i=0,c=!1;function d(e){var t=Math.floor(e/1e3),r=Math.floor(t/60),o=Math.floor(r/60);return"".concat(o,"h ").concat(r%60,"m ").concat(t%60,"s")}function p(){var t=n+s,o=t/a*100;e(".progress-bar").css("width",o+"%"),e("#total-processed").text(t),e("#success-count").text(n),e("#failed-count").text(s);var i=t/((Date.now()-r)/1e3);e("#processing-rate").text(i.toFixed(2));var c=(a-t)/i;e("#time-remaining").text(d(1e3*c)),e("#elapsed-time").text(d(Date.now()-r))}function u(){if(!o||c)return l("Order Generation stopped","warning"),void t("Order Generation stopped","warning");var r=a-(n+s);if(r<=0)return l("Order Generation complete!","success"),void t("Order Generation complete!","success");var d=Math.min(e("#batch_size").val(),r);e("#generation-status").text("Processing batch ".concat(i+1,"...")).removeClass().addClass("notice notice-info").show(),e.ajax({url:wcOrderGenerator.ajaxurl,type:"POST",data:{action:"process_order_batch",nonce:wcOrderGenerator.nonce,batch_size:d,batch_number:i},success:function(e){e.success?(n+=e.data.success,s+=e.data.failed,i++,p(),c?(l("Generation stopped","warning"),t("Order Generation stopped","warning")):setTimeout(u,500)):(v("Error processing batch: "+e.data),t("Eror processing batch","error"))},error:function(e,r,o){c?(l("Generation stopped","warning"),t("Order Generation stopped","warning")):(v("Server error occurred: "+o),t("Server error occurred","error"))}})}function l(t,r){e("#generation-status").text(t).removeClass().addClass("notice notice-".concat(r)).show(),o=!1,c=!1,e("#start-generation").prop("disabled",!1),e("#stop-generation").prop("disabled",!0),e("#reset-generation").show()}function v(e){s+=batchSize,p(),l(e,"error")}e("#order-generator-form").on("submit",(function(t){t.preventDefault();var d=parseInt(e("#num_orders").val());if(d<1||d>1e4)alert("Please enter a number between 1 and 10k");else{var p=parseInt(e("#batch_size").val());p<5||p>30?alert("Please enter a batch number between 5 and 30"):(o=!0,c=!1,a=d,n=0,s=0,i=0,r=Date.now(),e("#start-generation").prop("disabled",!0),e("#stop-generation").prop("disabled",!1),e("#reset-generation").hide(),e("#generation-status").text("Starting generation...").removeClass().addClass("notice notice-info").show(),e(".progress-bar").css("width","0%"),u())}})),e("#stop-generation").on("click",(function(){o&&(c=!0,e(this).prop("disabled",!0),e("#generation-status").text("Stopping generation...").removeClass().addClass("notice notice-warning").show(),e.ajax({url:wcOrderGenerator.ajaxurl,type:"POST",data:{action:"stop_order_generation",nonce:wcOrderGenerator.nonce}}).fail((function(e,t,r){})))})),e("#reset-generation").on("click",(function(){o=!1,c=!1,a=0,n=0,s=0,i=0,e(".progress-bar").css("width","0%"),e("#total-processed").text("0"),e("#success-count").text("0"),e("#failed-count").text("0"),e("#processing-rate").text("0"),e("#elapsed-time").text("0s"),e("#time-remaining").text("--"),e("#num_orders").val("100"),e("#start-generation").prop("disabled",!1),e("#stop-generation").prop("disabled",!0),e("#reset-generation").hide(),e("#generation-status").hide()}))})),jQuery(document).ready((function(e){function t(t){var r=e('\n            <div class="wc-toast '.concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",'">\n                ').concat(t,"\n            </div>\n        "));e("#toast-container").append(r),setTimeout((function(){return r.css("opacity","1")}),10),setTimeout((function(){r.css("opacity","0"),setTimeout((function(){return r.remove()}),300)}),3e3)}e("#toast-container").length||e("body").append('<div id="toast-container" style="position: fixed; top: 40px; right: 20px; z-index: 10000;"></div>');var r=!1,o=0,a=0,n=0,s=0;function i(){var t=(a+n)/o*100;e(".product-progress-bar").css("width",t+"%"),e("#products-processed").text(a),e("#products-failed").text(n)}function c(){if(!r)return e("#product-generation-status").text("Generation stopped").removeClass().addClass("notice notice-warning").show(),e("#start-product-generation").prop("disabled",!1),e("#stop-product-generation").prop("disabled",!0),e("#reset-product-generation").show(),void t("Product Generation stopped","warning");var p=o-(a+n);if(p<=0)return e("#product-generation-status").text("Product generation complete!").removeClass().addClass("notice notice-success").show(),e("#start-product-generation").prop("disabled",!1),e("#stop-product-generation").prop("disabled",!0),e("#reset-product-generation").show(),void t("Product Generation complete!","success");var u=Math.min(e("#product_batch_size").val(),p);e("#product-generation-status").text("Processing product batch ".concat(s+1,"...")).removeClass().addClass("notice notice-info").show(),e.ajax({url:wcOrderGenerator.ajaxurl,type:"POST",data:{action:"process_product_batch",nonce:wcOrderGenerator.products_nonce,batch_size:u,price_min:e("#price_min").val(),price_max:e("#price_max").val(),batch_number:s},success:function(e){e.success?(a+=e.data.success,n+=e.data.failed,s++,i(),setTimeout(c,500)):d("Error processing product batch: "+e.data)},error:function(){d("Server error occurred during product generation")}})}function d(t){n+=parseInt(e("#product_batch_size").val()),i(),e("#product-generation-status").text(t).removeClass().addClass("notice notice-error").show(),r=!1,e("#start-product-generation").prop("disabled",!1),e("#stop-product-generation").prop("disabled",!0),e("#reset-product-generation").show()}e("#product-generator-form").on("submit",(function(t){t.preventDefault();var i=parseInt(e("#num_products").val());if(i<1||i>1e4)alert("Please enter a number between 1 and 10k");else{var d=parseInt(e("#product_batch_size").val());d<5||d>30?alert("Please enter a batch number between 5 and 30"):(r=!0,o=i,a=0,n=0,s=0,Date.now(),e("#start-product-generation").prop("disabled",!0),e("#stop-product-generation").prop("disabled",!1),e("#reset-product-generation").hide(),e("#product-generation-status").text("Starting product generation...").removeClass().addClass("notice notice-info").show(),e(".product-progress-bar").css("width","0%"),c())}})),e("#stop-product-generation").on("click",(function(){r=!1,e(this).prop("disabled",!0),e("#product-generation-status").text("Stopping product generation...").removeClass().addClass("notice notice-warning").show()})),e("#reset-product-generation").on("click",(function(){r=!1,o=0,a=0,n=0,s=0,e(".product-progress-bar").css("width","0%"),e("#products-processed").text("0"),e("#products-failed").text("0"),e("#start-product-generation").prop("disabled",!1),e("#stop-product-generation").prop("disabled",!0),e("#reset-product-generation").hide(),e("#product-generation-status").hide()}))})),jQuery(document).ready((function(e){function t(t){var r=e('\n            <div class="wc-toast '.concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",'">\n                ').concat(t,"\n            </div>\n        "));e("#toast-container").append(r),setTimeout((function(){return r.css("opacity","1")}),10),setTimeout((function(){r.css("opacity","0"),setTimeout((function(){return r.remove()}),300)}),3e3)}e("#toast-container").length||e("body").append('<div id="toast-container" style="position: fixed; top: 40px; right: 20px; z-index: 10000;"></div>');var r=0,o=0;function a(s,i){var c=parseInt(e("#export-batch-size").val()),d=e("#export-status").val()||[],p=Math.ceil(r/c);e.ajax({url:wcOrderGenerator.ajaxurl,type:"POST",data:{action:"export_order_batch",nonce:wcOrderGenerator.export_nonce,batch_size:c,batch_number:s,total_batches:p,export_all:!0,statuses:d,export_session:i},success:function(d){if(d.success){var p=(s+1)*c;!function(a,s,i){if(!r||r<=0)t("Exporting number of order not found!","info");else{var c=Math.min(a/r*100,100);e(".export-progress-bar").css({width:c+"%","background-color":"blue",height:"25px",transition:"width 0.5s ease-in-out"}),e("#export-total-processed").text(a),e("#export-success-count").text(s),e("#export-failed-count").text(i);var d=Date.now(),p=o?d-o:0;e("#export-elapsed-time").text(p>0?n(p):"0s");var u=p>0?a/(p/1e3):0,l=r-a,v=u>0?l/u:0;e("#export-time-remaining").text(v>0?n(1e3*v):"0s")}}(Math.min(p,r),d.data.success,d.data.failed),d.data.is_last_batch?(e("#start-order-export").prop("disabled",!1),window.location.href=d.data.download_url):a(s+1,i)}else t("Export batch failed!"+d.data,"error")}})}function n(e){var t=Math.floor(e/1e3),r=Math.floor(t/60),o=Math.floor(r/60);return"".concat(o,"h ").concat(r%60,"m ").concat(t%60,"s")}e("#export-all").prop("checked",!0),e("#order-export-form").on("submit",(function(n){n.preventDefault();var s=parseInt(e("#export-batch-size").val()),i=e("#export-status").val()||[];e.ajax({url:wcOrderGenerator.ajaxurl,type:"POST",data:{action:"start_order_export",nonce:wcOrderGenerator.export_nonce,batch_size:s,export_all:!0,statuses:i},success:function(n){n.success?(r=n.data.total_orders,o=Date.now(),e("#start-order-export").prop("disabled",!0),a(0,n.data.export_session)):t("Export initialization failed: "+n.data,"error")}})})),e("#reset-order-export").on("click",(function(){e(".export-progress-bar").css("width","0%"),e("#export-total-processed, #export-success-count, #export-failed-count").text("0"),e("#export-elapsed-time").text("0s"),e("#export-time-remaining").text("--"),e("#start-order-export").prop("disabled",!1)}))})),jQuery(document).ready((function(e){function t(t){var r=e('\n            <div class="wc-toast '.concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",'">\n                ').concat(t,"\n            </div>\n        "));e("#toast-container").append(r),setTimeout((function(){return r.css("opacity","1")}),10),setTimeout((function(){r.css("opacity","0"),setTimeout((function(){return r.remove()}),300)}),3e3)}e("#toast-container").length||e("body").append('<div id="toast-container" style="position: fixed; top: 40px; right: 20px; z-index: 10000;"></div>'),e("#order-import-form").on("submit",(function(r){r.preventDefault();var o=e(".file-upload-input")[0].files[0];if(!o)return t("Please select a CSV file","warning"),r.preventDefault(),!1;var a=o.name.toLowerCase().endsWith(".csv");if(!["text/csv","application/vnd.ms-excel"].includes(o.type)||!a)return t("Invalid file type. Please upload a .csv file","error"),r.preventDefault(),!1;if(o.size>5242880)return t("File size exceeds 5MB limit","warning"),r.preventDefault(),!1;var n=new FormData(this);n.append("action","import_orders"),n.append("nonce",wcOrderGenerator.import_nonce),n.append("current_batch",0);var s=Date.now(),i=0,c=0;!function r(o){e.ajax({url:wcOrderGenerator.ajaxurl,type:"POST",data:o,processData:!1,contentType:!1,success:function(a){if(a.success){var n=Date.now(),d=Math.floor((n-s)/1e3);i=a.data.total_orders,c+=a.data.successful,e("#import-total-processed").text(c),e("#import-success-count").text(c),e("#import-failed-count").text(a.data.failed),e("#import-skipped-count").text(a.data.skipped),e("#import-elapsed-time").text(d+"s");var p=Math.floor(c/i*100);if(e(".import-progress-bar").css({width:p+"%","background-color":"blue",height:"25px",transition:"width 0.5s ease-in-out"}),a.data.is_complete)return t("Order Import complete!","success"),void e(".import-progress-bar").css("background-color","green");var u=new FormData;u.append("action","import_orders"),u.append("nonce",wcOrderGenerator.import_nonce),u.append("current_batch",a.data.current_batch+1),u.append("csv_file",o.get("csv_file")),u.append("batch_size",o.get("batch_size")),r(u)}else t("Order Import failed!"+a.data,"warning")},error:function(){t("Server error occurred!","error")}})}(n)})),e("#reset-order-import").on("click",(function(){exportIsGenerating=!1,e(".import-progress-bar").css("width","0%"),e("#import-total-processed, #import-success-count, #import-failed-count").text("0"),e("#import-elapsed-time").text("0s"),e(".file-upload-input").val(""),e(".file-upload-preview").html('\n            <div class="upload-placeholder">\n                <i class="upload-icon">ðŸ“¤</i>\n                <span class="upload-text">Drag & Drop or Click to Upload CSV</span>\n            </div>\n        ')}))}));